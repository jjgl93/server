- name: Playbook de prueba  
  hosts: win19
  
  tasks:
        
  - name: Comprobando que el sistema es Server 2019
    win_command: cmd.exe /c systeminfo | find /i "Sistema Operativo"
    register: version
    failed_when: "'Windows Server 2019' not in version.stdout"
    changed_when: False
    
    
  - name: Comprobando valor variable de entorno
    win_command: cmd.exe /c SET BLUENCE_HOME
    register: HDD

  - name: Ver variable
    debug: var=HDD
    
  - name: Comprobar memoria si est√° en C:\
    ansible.windows.win_powershell:
      script: |
        Get-WmiObject Win32_LogicalDisk -Filter "DeviceID='C'" | select-object Freespace | % {$_.FreeSpace=($_.FreeSpace/1GB);$_.Size=($_.Size/1GB);$_}
    register: memory
    failed_when: "'C:\' not in HDD.stdout"
    changed_when: False

  - name: Ver variable
    debug: var=memory
