- hosts: win1
  collections:
    - community.windows
    
  tasks:
  
    - name: Ansible check project tmp directory
      delegate_to: localhost
      stat:
        path: /tmp/Descarga-Git
      register: my_folder

    - name: "echo if project's last build directory already existed"
      delegate_to: localhost
      file:
        path: /tmp/Descarga-Git
        state: absent
      when: my_folder.stat.exists

    - name: "Ansible Create Integration directory if not exists"
      delegate_to: localhost
      file:
        path: /tmp/Descarga-Git
        state: directory
        mode: 0755
        recurse: true
        
    - name: Git checkout
      delegate_to: localhost
      ansible.builtin.git:
        repo: https://github.com/jjgl93/server.git
        dest: /tmp
        archive: /tmp/Descarga-Git/prueba_git.zip
        version: v1

    - name: copiar archivo de localhost a host
      ansible.windows.win_copy:
        backup: yes
        src: "/tmp/Descarga-Git/prueba_git.zip"
        dest: "C:\\Users\\Administrador\\Desktop\\prueba_git.zip"
      register: copyhost
